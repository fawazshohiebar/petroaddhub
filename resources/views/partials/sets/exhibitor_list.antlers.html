<!-- The container for the scoped Vue app -->
<div id="exhibitor-container" class="exhibitor-container adnec-container mx-auto" ></div>
<script>
  const containerSelector = '.exhibitor-container';
  const container = document.querySelector(containerSelector);

  // 1. Inject Material Design Icons (required for Vuetify icons to show)
  const mdiFont = document.createElement('link');
  mdiFont.rel = 'stylesheet';
  mdiFont.href = 'https://cdn.jsdelivr.net/npm/@mdi/font@7.3.67/css/materialdesignicons.min.css';
  document.head.appendChild(mdiFont);

  // 2. Fetch and scope the third-party CSS
  fetch('https://ezone-exhibitor-list.s3.me-central-1.amazonaws.com/assets/index.css?id={{links_id ?? "123456444"}}')
    .then(res => res.text())
    .then(originalCss => {
      const scopedCss = originalCss.replace(/(^|\})\s*([^{@}]+)\s*\{/g, (match, sep, selectors) => {
        const scoped = selectors
          .split(',')
          .map(sel => `${containerSelector} ${sel.trim()}`)
          .join(', ');
        return `${sep} ${scoped} {`;
      });

      const style = document.createElement('style');
      style.textContent = scopedCss;
      document.head.appendChild(style);
    });

  // 3. Inject the expected HTML structure into the container
  container.innerHTML = `
    <div
      id="app"
      class="exhibitor-list-app"
      data-base-url="{{ezone_base_url}}"
      data-main-color="{{main_color}}"
      data-color-level="{{color_level}}"
      data-event-id="{{event_id}}"
      data-event-type="{{event_type}}"
      {{if has_products == true}}
      data-has-products="true"
      {{/if}}
      {{if has_brands == true}}
      data-has-brands="true"
      {{/if}}

      {{if show_classification == true}}
      data-show-classification="true"
      {{/if}}
      {{if show_product_awards == true}}
      data-show-product-awards="true"
      {{/if}}
      data-scroll-margin-top="{{scroll_margin_top}}"
      
      {{if invisual_prefix}}
      data-invisual-prefix="{{invisual_prefix}}"
      {{/if}}

      {{if awards_search_active_on}}
      data-awards-search-active-on="{{awards_search_active_on}}"
      {{/if}}

      {{if awards_title}}
      data-awards-title="{{awards_title}}"
      {{/if}}

      {{if external_search_prefix}}
      data-external-search-prefix="{{external_search_prefix}}"
      {{/if}}

      {{if show_contact_details}}
      data-show-contact-details="true"
      {{/if}}

    ></div>
  `;

  // 4. Load the Vue app (JS bundle)
  const script = document.createElement('script');
  script.type = 'module';
  script.crossOrigin = 'anonymous';
  script.src = 'https://ezone-exhibitor-list.s3.me-central-1.amazonaws.com/assets/index.js?id={{links_id ?? "123456444"}}';
  document.body.appendChild(script);
</script>

<style>
  :root {
  --v-theme-overlay-multiplier: 1;
}
</style>
 